# PLAN.md

## Overview
Dokumen ini merangkum rencana pengembangan dan status implementasi saat ini untuk proyek OrionAi. Bagian ini juga mencatat perubahan penting yang telah dilakukan — khususnya backend yang diimplementasikan menggunakan Python (FastAPI) dan integrasi awal antara frontend dan backend.

## Tujuan Utama
1. Menyediakan backend Python (FastAPI) sebagai service inti dan proxy ke model lokal (Ollama).
2. Membangun frontend interaktif menggunakan React + TypeScript (Vite) untuk interaksi pengguna.
3. Mengimplementasikan RAG (retrieval-augmented generation) dan Memory Bank untuk menyimpan konteks percakapan.
4. **Character Roleplay System** - Fitur mirip Character.ai dengan smart description generation.

## Current Implementation (Status)
- **Backend:** Implementasi utama menggunakan **Python + FastAPI**.
  - File entry: `backend/main.py` dan utilitas `backend/seed_data.py`.
  - Struktur kode: `backend/src/api/router.py`, `backend/src/core/config.py`, `backend/src/llm/ollama_client.py`.
  - RAG & memory: modul berada di `backend/src/rag/` termasuk `ai_persona.py`, `character_personas.py`, `conversations.py`, dan `memory_bank.py`.
  - **Character Personas API:** Full CRUD dengan smart generation via Ollama.
  - Backend sudah menyediakan endpoint dasar (contoh: `/chat`, `/persona`, `/conversations`, `/character_personas`, `/character/{id}`) yang dapat diuji via `curl`.

- **Frontend (Interface):** React + TypeScript, disusun di folder `interface/`.
  - Entry: `interface/src/main.tsx`, routing dan komponen di `interface/src/pages/`.
  - **Character Chat Page:** `CharacterChatPage.tsx` dengan side panel mirip Character.ai.
  - **Characters Page:** `CharactersPage.tsx` untuk view all characters dengan filter kategori.
  - Tools: beberapa komponen tools termasuk `MediaPlayer` telah diimplementasikan.

- **Dev setup:** Frontend dijalankan via Vite (`npm run dev` di `interface/`). Backend dijalankan via Uvicorn/FastAPI.

## Character Persona Schema (New)
```typescript
interface CharacterPersona {
  character_id: string;       // UUID
  name: string;
  user_relationship: string;  // e.g. "Mentor-Acolyte", "Partner-in-Crime"
  character_role: string;     // e.g. "Guide", "Mentor", "Partner"
  user_persona_nickname: string | null;  // Panggilan karakter ke user
  greeting: string;
  short_description: string;
  tags: string[];             // e.g. ["Fantasy", "Knight", "Mentor"]
  voice_id: string | null;
  visibility: "private" | "public" | "unlisted";
  category: string;           // e.g. "fantasy", "scifi", "cyberpunk"
  definition: string;         // Generated by Ollama LLM
}
```

## API Endpoints (Character Personas)
| Method | Endpoint | Description |
|--------|----------|-------------|
| GET | `/character_personas` | List all character personas |
| GET | `/character/{id}` | Get character by UUID |
| POST | `/character` | Create + smart generation via Ollama |
| PUT | `/character/{id}` | Update character |
| PUT | `/character/{id}/activate` | Set character as active |
| DELETE | `/character/{id}` | Delete character |

## Frontend Routes
| Route | Component | Description |
|-------|-----------|-------------|
| `/` | Redirect | → `/chat` |
| `/chat` | ChatPage | Regular AI chat |
| `/chat/:id` | ChatPage | Chat with conversation ID |
| `/conversations` | ConversationsPage | View all conversations |
| `/characters` | CharactersPage | View all character personas |
| `/char/:characterId` | CharacterChatPage | Roleplay chat with character |
| `/tool/*` | ToolRoutes | Various tools |
| `/memory` | MemoryBank | Memory bank management |
| `/settings` | Settings | App settings |

## Milestones (Updated)

### Milestone 1: Setup Dasar Proyek — Status: Done ✅
- React + TypeScript + Vite disiapkan di `interface/`.
- Styling dengan Tailwind sudah dipakai di komponen UI.

### Milestone 2: Backend & Proxy — Status: Done ✅
- Backend menggunakan **FastAPI** sebagai server utama.
- Endpoint dasar dan klien Ollama (`ollama_client.py`) ada di `backend/src/llm/`.
- Middleware CORS dan konfigurasi dikelola di `backend/src/core/config.py`.

### Milestone 3: Core RAG & Memory Bank — Status: In progress
- Struktur modul RAG dan Memory Bank ada di `backend/src/rag/`.
- Perlu penambahan tes dan integrasi dengan vector DB (mis. Chroma) bila diperlukan.

### Milestone 4: Character Roleplay System — Status: Done ✅
- Character Personas backend dengan smart description generation via Ollama.
- Frontend Character Chat page dengan side panel (mirip Character.ai).
- View All Characters page dengan kategori dan filter.

### Milestone 5: Integrasi Frontend-Backend & UI — Status: Done ✅
- Frontend sudah mengonsumsi endpoint backend.
- Character chat terintegrasi dengan Ollama untuk roleplay responses.

### Milestone 6: Pengujian dan Debugging — Status: Ongoing
- Perlu menambahkan unit tests untuk backend dan komponen frontend.

### Milestone 7: Deployment — Status: Planned
- Siapkan konfigurasi build dan Docker deployment setelah pengujian selesai.

## Dependencies (Ringkasan)

### Backend
- Python 3.10+
- FastAPI, Uvicorn
- httpx (atau requests) untuk HTTP client
- python-dotenv untuk environment
- (Opsional) LangChain / LlamaIndex untuk orkestrasi RAG

### Frontend
- React + TypeScript (Vite)
- Tailwind CSS
- lucide-react (ikon)
- react-router-dom (routing)

## Notable Changes / Decisions
- Backend pilihan final: **Python + FastAPI** (bukan Node/Express).
- Frontend tetap di React + TypeScript dengan Tailwind CSS.
- Character Personas menggunakan schema baru dengan `user_relationship`, `character_role`, `user_persona_nickname`, dan `tags`.
- Side panel pada Character Chat terinspirasi dari UI Character.ai.

## Next Steps (Prioritas)
1. **Memory Bank Enhancement:** Implementasi fitur Memory Bank yang lebih lengkap.
2. **Create Character Form:** UI untuk membuat character persona baru dari frontend.
3. **Testing:** Tambah pengujian unit untuk backend dan frontend.
4. **Vector DB Integration (opsional):** ChromaDB atau alternatif untuk semantic search.
5. **CI/CD & Deployment:** Dockerfile dan pipeline build.

## How to Run (Quick)
- Frontend (development):
```powershell
cd H:\AiProject\OrionAi\interface
npm install
npm run dev
```
- Backend (development):
```powershell
cd H:\AiProject\OrionAi\backend
pip install -r requirements.txt
uvicorn main:app --reload --port 8000
```

## Notes
- Pastikan Ollama running di `http://localhost:11434` untuk character generation.
- Frontend berjalan di `http://localhost:5173`, backend di `http://localhost:8000`.
- Character chat tersedia di `/char/{character_id}`.

---
_Dokumen ini diperbarui 2025-12-06 untuk mencerminkan Character Roleplay System implementation._
